$(document).ready(function(){AV.initialize("blgx18bu3llnxjmstq0q528k7ogjwgqnlv3tm9b1926af47x","zwdgquddmljlde2crhfztjk0csrzplv0x5wlk2odpgqmoh0u");var t={config:{},method:{},states:{singleShow:!1}},e=function(t){for(var e,i=[],a=[],o=[],n=[],r=[],l=[],s=[],d=[],c=[],m=[],u=t.length-1,h=0;u>=h;u--)e=t[u].attributes.time_point.split("T")[1],e=e.split(":")[0],"00"==e&&(e=t[u].attributes.time_point.split("T")[0],e=e.split("-")[2]+"日"),i.push(e),a.push(t[u].attributes.aqi),r.push(t[u].attributes.co),s.push(t[u].attributes.no2),l.push(t[u].attributes.o3),o.push(t[u].attributes.pm2_5),n.push(t[u].attributes.pm10),c.push(t[u].attributes.primary_pollutant),m.push(t[u].attributes.quality),d.push(t[u].attributes.so2);$("#pm25-value").html(o[o.length-1]),$(function(){$("#pm25-charts").highcharts({chart:{animation:{duration:1500},backgroundColor:"#06122a",type:"spline"},title:{text:"空气质量详情",x:-20,style:{color:"#999999","font-family":"Microsoft Yahei"}},subtitle:{text:"Source: PM2.5in",x:-20},credits:{enabled:!1},plotOptions:{spline:{marker:{radius:2,lineColor:"#666666",lineWidth:1,enabled:!1,states:{hover:{enabled:!1}}},stickyTracking:!0}},xAxis:{categories:i},yAxis:{title:{text:"数值",style:{color:"#999999","font-family":"Microsoft Yahei"}},plotLines:[{value:0,width:1,color:"#808080"}],min:0},tooltip:{crosshairs:!0,shared:!0,useHTML:!0,headerFormat:"<table>",pointFormat:'<tr><td style="color: {series.color}">{series.name}: </td><td style="text-align: right"><b>{point.y}</b></td></tr>',footerFormat:"</table>"},legend:{layout:"vertical",align:"right",verticalAlign:"middle",borderWidth:0,itemHiddenStyle:{color:"#333333"},itemHoverStyle:{color:"#ffffff"},itemStyle:{"padding-bottom":"10px","font-size":"14px","font-family":"tohoma","font-weight":"bold"}},series:[{name:"AQI",id:"aqi",data:a},{name:"PM2.5",id:"pm2_5",data:o,color:"#acb0b8"},{name:"PM10",id:"pm10",data:n},{name:"SO2",id:"so2",data:d},{name:"NO2",id:"no2",data:s},{name:"O3",id:"o3",data:l}]})})};!function(){var t=AV.Object.extend("azure_aqi");new t;var i=new AV.Query(t);i.select("time_point","aqi","co","no2","o3","pm2_5","pm10","primary_pollutant","quality","so2"),i.descending("createdAt"),i.limit(12),i.find().then(function(t){e(t)})}(),function(){var t=AV.Object.extend("Infos");new t;var e=new AV.Query(t);e.select("info","forecast"),e.descending("createdAt"),e.limit(1),e.find().then(function(t){var e=t[0].attributes.info,i=t[0].attributes.forecast;$("#info").html(e),$("#forecast").html(i),console.log(i)})}(),function(){var t="http://api.openweathermap.org/data/2.5/weather";$.ajax({type:"get",dataType:"jsonp",url:t,data:{q:"Beijing",lang:"zh_cn",units:"metric"},success:function(t){function e(){var e=t.weather[0].id;return e>=200&&300>e?(a.html("&#xf020b;"),void 0):e>=300&&400>e?(a.html("&#xf020a;"),void 0):e>=500&&600>e?(a.html("&#xf0209;"),void 0):e>=600&&700>e?(a.html("&#xf0276;"),void 0):e>=700&&800>e?(a.html("&#xf0208;"),void 0):e>=800&&900>e?800==e?(a.html("&#xf0205;"),void 0):(a.html("&#xf0206;"),void 0):e>=900&&1e3>e?(a.html("&#xf0205;"),void 0):void 0}var i=t.main.temp,a=$("#w-icon");e(),$("#render-temp").html(i)}})}(),function(){$("#toggle-charts").on("change",function(){var e=Highcharts.charts[0],i=["aqi","no2","o3","pm10","so2"];if(t.states.singleShow){for(var a=0;a<i.length;a++)e.get(i[a]).show();t.states.singleShow=!1}else{for(var a=0;a<i.length;a++)e.get(i[a]).hide();t.states.singleShow=!0}}),$(".switch").css("height",$(window).height())}()});